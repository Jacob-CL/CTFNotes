# Chapter 3 - Classical Encryption Techniques
Symmetric encryption, also referred to as conventional encryption or single-key encryption, was the only type of encryption in use prior to the development of public-key encryption in the the 1970s. It reamins the most widely used.

## 3.1 Symmetric Cipher Model
A symmetric encryption scheme has 5 ingredients:
1. Plaintext: This is the original intelligible message or data that is fed into the algorithm
2. Encryption algorithm: The encryption algorithm performs various substitutions and tranformations on the plaintext.
3. Secret key: The secret key is also input to the encryption algo. The key is a value indepedent of the plaintext and of the algo. The algo will produce a different output depending on the specific key being used at the time. The exact substitutions and transformations performed by the algo depend on the key.
4. Ciphertext: This is the scrambled message produced as output. It depedns on the plaintext and the secrey keys. For a given message, 2 different keys will produce two different ciphertexts. The ciphertext is an apparently random stream of data, as it stands is unintelligibile.
5. Decrpytion algorithm: This is essentially the encryption algo run in reverse. It takes the ciphertext and the secret and produces the original plaintext.

To use such a methodology securely, you need to have a strong encryption algo and the sender and receiver must have obtained copies of the secret key in a secure fashion, and obviously kept secure as well.

### Cryptology
Cryptographic systems are characterized along 3 indepedent dimensions
1. Type of operations used for transforming plaintext to ciphertext: All encryption algorithms are based on either substitution (in which each element in the plaintext (bit, letter, group of bits or letters) is mapped into another element OR transposition (where elements in the plaintext are rearranged). Most systems involve multiple stages of both.
2. The number of keys used: If send and receiver both use the same key then the system is refered to as symmetric, single key, secret key or conventional encryption. If the sender and receiver use different keys then the system is referred to as asymmetric, two-key or public key encryption.
3. The way in which the plaintext is processed: A block cipher processes the input one block of elements at a time, producing an output block for each input block. A stream cipher processes the input elements continously, producing output one element at a time, as it goes along.

### Cryptanalysis and Brute-force Attack
Typically, the objective of attacking an encryption system is to recover the key in use rather than simply recover the plaintext of a single ciphertext. There are 2 general approaches to attacking a conventional encryption scheme:
- Cryptanalysis: Relies on the nature of the algorithm plus perhaps some knowledge of the general characteristics of the plain text or even some sample plaintext-ciphertext pairs.
- Brute-force attack: The attacker tries every possible key on a piece of ciphertext until an intelligble translation into plaintext is obtained.

<img width="847" height="495" alt="image" src="https://github.com/user-attachments/assets/afafcc0c-22da-4bce-8f83-6b1c1a2e042c" />

There is such a thing as a probable-word attack where it's guessed that a specific word(s) appear in the ciphertext and from there you can deduce the plaintext and is unravels. If the analyst is able to somehow to get the source system to insert into the system a message chosen by the analyst, then a chosen-plaintext attack is possible. In general, if the analysts is able to choose the message to encrypt, the analyst may deliberately pick patterns that can be expected to reveal the structure of the key.

An encryption scheme is unconditionally secure if the ciphertext generated by the scheme does not contian enough information to determine uniquely the corresponding plaintext. With the exception of a OTP, there is no encryption method that is unconditionally secure. Therefore, all that users can strive for is an algorithm that meets one or both of the following:
- The cost of breaking the cipher exceeds the value of encrypted information
- The time required to break the cipher exceeds the useful lifetime of the information
An ecryption scheme is said to be conditionally secure if either of the above are met - although its very difficult to estimate the amount of effort required to cryptanalyze ciphertext successfully.
```
All forms of cryptanalysis for symmetric encryption are designed to exploit the fact that traces of structure or pattern in the plaintext may survive encryption
```

### Brute force attack
- It is important to note that there is more to a brute-force attack than simply running through all possible keys. Unless a known plaintext is provided, the analyst must be able to recognize plaintext as plaintext. If the message is in plaintext English then the result pops out easily although the task of recognizing English would be difficult to automate.
- If the message has been compressed before encryption then recognition is even harder. Therefore, for brute forcing to be successful it needs to be supplemented with some degree of knowledge of the lpaintext and some means of automatically distinguishing plaintext from the the gibberish.

### Strong Encryption
- The term is an imprecise one but refers to encryption that makes it impractically difficult for unauthorized persons or systems to gain access to plaintext that has been encrypted.
- NAS18 lists the following properties that make an encryption algorithm strong: appropriate choice of cryptographic algo, use of sufficiently long key lengths, appropriate choice of protocols, a well engineered implementation, and the absence of deliberately introduced hidden flaws.

## 3.2 Substitution Ciphers
### Caesars Cipher
- We know about this one - they are easily broken because there are only 25 keys to try and super susceptable to a brute force.
- What generally makes brute-force impractical is the use of an algo that employs a large number of keys. E.g triple DES makes use of a 168-bit key, giving a key space of 2^168.

### Monoalphabetic Ciphers
- Since Caesar Cipher is so insecure due to it's 25 keys, a dramatic increase in the key space can be achieved by allowing an arbituary substitution.
- A permutation of a finite set of element `s` is an ordered sequence of all the elements of `s`, with each element appearing exactly once. e.g if `s = {a,b,c}` then there are 6 permutations of `s`: abc, acb, bac, bca, cab, cba.
- So if any letter can represent another letter, then are are greater than 4 x 10^26 possible keys which is much stronger and would seem to eliminate brute-force techniques. Such an approach is reffered to as a monoalphabetic substitution cipher, because a single cipher alphabet is user per message.
- However, if the analyst knows the nature of the plaintext, then the analyst can exploit the regularities of the language.
- Here frequency analysis might be enough if the plaintext is long enough to gleam patterns from. Also look for known words in the text or we could look for repeating sequences of cipher lettes and try to deduce their plaintext equivalents.
- Digrams frequency analysis is super handy as well, usually in conjunction with regular frequency analysis. So you might use frequency analysis to discern `e` but then digram analysis to guess `th`. Then from there you might find the most common trigram (`the`) and if they all line up then you might be in business.
- Monoalphabetic ciphers are easy to break because they reflect the frequency data of the original alphabet. The counter measure is to provide multiple substitutes, known as homophones, for a single letter. e.g `e` could be a number of different symbols.
- Should that be the case then the Only four letters have been identified, but already we have quite a bit of the message. Continued analysis of frequencies plus trial and error should easily yield a solution from this point. The complete plaintext, with spaces added between words, follows: Monoalphabetic ciphers are easy to break because they reflect the frequency data of the original alphabet. A countermeasure is to provide multiple substitutes, known as homophones, for a single letter. For example, the letter e could be assigned a number of different cipher symbols, such as 16, 74, 35, and 21, with each homophone assigned to a letter in rotation or randomly. If the number of symbols assigned to each letter is proportional to the relative frequency of that letter, then single-letter frequency information is completely obliterated.
- 2 methods are used in substitution ciphers to lessen the extent to which the structure of the plaintext survives in the ciphertext: One approach is to encrypt multiple letters of plaintext, the other is to use multiple cipher alphabets.

### Playfair Cipher
The best-known multiple-letter encryption cipher is the Playfair, which treats digrams in the plaintext as single units and translates these units into ciphertext digrams. The Playfair algorithm is based on the use of a 5 Ã— 5 matrix of letters constructed using a keyword.
 
<img width="427" height="231" alt="image" src="https://github.com/user-attachments/assets/7e0313df-af37-4f24-afb2-f4d0a5f65351" />

There keyword here is `monarchy`. The rest is then filled in by the remaining letters of the alphabet from left-right, top-bottom, in alphabetic order. The plaintext is encrypted 2 letters at a time, according to the following rules:
1. Repeating plaintext letters that are in the same pair are separated with a filler letter, such as x, so that balloon would be treated as ba lx lo on.
2. Two plaintext letters that fall in the same row of the matrix are each replaced by the letter to the right, with the first element of the row circularly following the last. For example, `ar` is encrypted as RM.
3. Two plaintext letters that fall in the same column are each replaced by the letter beneath, with the top element of the column circularly following the last. For example, `mu` is encrypted as `CM`.
4. Otherwise, each plaintext letter in a pair is replaced by the letter that lies in its own row and the column occupied by the other plaintext letter. Thus, `hs` becomes `BP` and `ea` becomes `IM` (or `JM`, as the encipherer wishes).

The Playfair cipher was for a long time considered unbreakable and was relied upon by the British Army in World War 1 and still enjoyed considerable use by the U.S Army and other Allied forces during World War 2. This reveals the effectiveness of the playfair cipher compared to others:
<img width="823" height="560" alt="image" src="https://github.com/user-attachments/assets/70047ccb-549b-4149-b322-85ec81bace1f" />

### Hill Cipher







